	/**
	 * Opens a stack of tables for reading.
	 *
	 * @param ctx
	 *            context to read the tables with. This {@code ctx} will be
	 *            retained by the stack and each of the table readers.
	 * @param tables
	 *            the tables to open.
	 * @return stack reference to close the tables.
	 * @throws IOException
	 *             a table could not be opened
	 */
	public static ReftableStack open(DfsReader ctx, List<DfsReftable> tables)
			throws IOException {
		ReftableStack stack = new ReftableStack(tables.size());
		boolean close = true;
		try {
			for (DfsReftable t : tables) {
				stack.tables.add(t.open(ctx));
			}
			close = false;
			return stack;
		} finally {
			if (close) {
				stack.close();
			}
		}
	}

