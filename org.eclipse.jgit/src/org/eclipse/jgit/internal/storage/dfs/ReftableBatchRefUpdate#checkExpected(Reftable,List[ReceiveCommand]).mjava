	private boolean checkExpected(Reftable table, List<ReceiveCommand> pending)
			throws IOException {
		for (ReceiveCommand cmd : pending) {
			Ref ref;
			try (RefCursor rc = table.seekRef(cmd.getRefName())) {
				ref = rc.next() ? rc.getRef() : null;
			}
			if (!matchOld(cmd, ref)) {
				cmd.setResult(LOCK_FAILURE);
				if (isAtomic()) {
					ReceiveCommand.abort(pending);
					return false;
				}
			}
		}
		return true;
	}

