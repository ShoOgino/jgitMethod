	@Override
	public ObjectId insert(final int type, long len, final InputStream is)
			throws IOException {
		if (len <= buffer().length) {
			byte[] buf = buffer();
			int actLen = IO.readFully(is, buf, 0);
			return insert(type, buf, 0, actLen);

		} else {
			MessageDigest md = digest();
			File tmp = toTemp(md, type, len, is);
			ObjectId id = ObjectId.fromRaw(md.digest());
			return insertOneObject(tmp, id);
		}
	}

