	public RefDirectoryUpdate newUpdate(String name, boolean detach)
			throws IOException {
		final RefList<Ref> packed = getPackedRefs();
		Ref ref = readRef(name, packed);
		if (ref != null)
			ref = resolve(ref, 0, null, null, packed);
		if (ref == null)
			ref = new ObjectIdRef.Unpeeled(NEW, name, null);
		else if (detach && ref.isSymbolic())
			ref = new ObjectIdRef.Unpeeled(LOOSE, name, ref.getObjectId());
		return new RefDirectoryUpdate(this, ref);
	}

