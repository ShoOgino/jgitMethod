	private static String getEmailInternal(Config rc, String envKey) {
		// try to get the email from the local and global configurations.
		String email = rc.getString("user", null, "email"); //$NON-NLS-1$ //$NON-NLS-2$

		if (email == null) {
			// try to get the email for the system property GIT_XXX_EMAIL
			email = system().getenv(envKey);
		}

		return stripInvalidCharacters(email);
	}

