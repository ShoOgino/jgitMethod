	@Override
	public void materialize(final WindowCursor curs) throws IOException {
		if (cachedBytes != null) {
			return;
		}

		if (objectType != OBJ_COMMIT) {
			final UnpackedObjectCache.Entry cache = pack.readCache(dataOffset);
			if (cache != null) {
				curs.release();
				objectType = cache.type;
				objectSize = cache.data.length;
				cachedBytes = cache.data;
				return;
			}
		}

		try {
			final PackedObjectLoader baseLoader = getBaseLoader(curs);
			baseLoader.materialize(curs);
			cachedBytes = BinaryDelta.apply(baseLoader.getCachedBytes(),
					pack.decompress(dataOffset, deltaSize, curs));
			curs.release();
			objectType = baseLoader.getType();
			objectSize = cachedBytes.length;
			if (objectType != OBJ_COMMIT)
				pack.saveCache(dataOffset, cachedBytes, objectType);
		} catch (DataFormatException dfe) {
			final CorruptObjectException coe;
			coe = new CorruptObjectException("Object at " + dataOffset + " in "
					+ pack.getPackFile() + " has bad zlib stream");
			coe.initCause(dfe);
			throw coe;
		}
	}

