	@Test
	public void testExclude() throws Exception {
		FileRepository repo = createBareRepository();

		TestRepository<FileRepository> testRepo = new TestRepository<FileRepository>(
				repo);
		BranchBuilder bb = testRepo.branch("refs/heads/master");
		RevBlob contentA = testRepo.blob("A");
		RevCommit c1 = bb.commit().add("f", contentA).create();
		testRepo.getRevWalk().parseHeaders(c1);
		PackIndex pf1 = writePack(repo, Collections.singleton(c1),
				Collections.<PackIndex> emptySet());
		assertContent(
				pf1,
				Arrays.asList(c1.getId(), c1.getTree().getId(),
						contentA.getId()));
		RevBlob contentB = testRepo.blob("B");
		RevCommit c2 = bb.commit().add("f", contentB).create();
		testRepo.getRevWalk().parseHeaders(c2);
		PackIndex pf2 = writePack(repo, Collections.singleton(c2),
				Collections.singleton(pf1));
		assertContent(
				pf2,
				Arrays.asList(c2.getId(), c2.getTree().getId(),
						contentB.getId()));
	}

