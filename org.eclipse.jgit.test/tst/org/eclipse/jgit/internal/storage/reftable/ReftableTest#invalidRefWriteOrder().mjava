	@Test
	public void invalidRefWriteOrder() throws IOException {
		Ref master = ref(MASTER, 1);
		Ref next = ref(NEXT, 2);
		ReftableWriter writer = new ReftableWriter(new ByteArrayOutputStream())
			.setMinUpdateIndex(1)
			.setMaxUpdateIndex(1)
			.begin();

		writer.writeRef(next);
		IllegalArgumentException e  = assertThrows(
			IllegalArgumentException.class,
			() -> writer.writeRef(master));
		assertThat(e.getMessage(), containsString("records must be increasing"));
	}

