	@Test
	public void testReadSmallBuffer() throws IOException {
		DfsOutputStream os = newDfsOutputStream(8);
		os.write(Constants.encode("data"));
		assertEquals("data", readBuffered(os.openInputStream(0), 2));
		assertEquals("ata", readBuffered(os.openInputStream(1), 2));
		assertEquals("ta", readBuffered(os.openInputStream(2), 2));
		assertEquals("a", readBuffered(os.openInputStream(3), 2));
		assertEquals("", readBuffered(os.openInputStream(4), 2));
		assertEquals("", readBuffered(os.openInputStream(5), 2));
	}

