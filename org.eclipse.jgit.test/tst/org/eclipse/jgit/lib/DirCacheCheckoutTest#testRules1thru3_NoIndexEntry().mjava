	@Test
	public void testRules1thru3_NoIndexEntry() throws IOException {
		ObjectId head = buildTree(mk("foo"));
		TreeWalk tw = TreeWalk.forPath(db, "foo", head);
		ObjectId objectId = tw.getObjectId(0);
		ObjectId merge = db.newObjectInserter().insert(Constants.OBJ_TREE,
				new byte[0]);

		prescanTwoTrees(head, merge);

		assertTrue(getRemoved().contains("foo"));

		prescanTwoTrees(merge, head);

		assertEquals(objectId, getUpdated().get("foo"));

		merge = buildTree(mkmap("foo", "a"));
		tw = TreeWalk.forPath(db, "foo", merge);
		ObjectId anotherId = tw.getObjectId(0);

		prescanTwoTrees(head, merge);

		assertEquals(anotherId, getUpdated().get("foo"));
	}

