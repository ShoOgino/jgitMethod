	protected void tearDown() throws Exception {
		RepositoryCache.clear();
		db.close();
		for (Repository r : repositoriesToClose)
			r.close();

		// Since memory mapping is controlled by the GC we need to
		// tell it this is a good time to clean up and unlock
		// memory mapped files.
		if (packedGitMMAP)
			System.gc();

		final String name = getClass().getName() + "." + getName();
		recursiveDelete(trash, false, name, true);
		for (Repository r : repositoriesToClose)
			recursiveDelete(r.getWorkDir(), false, name, true);
		repositoriesToClose.clear();

		super.tearDown();
	}

