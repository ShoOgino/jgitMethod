	@Test
	public void pushAtomicClientGivesUpEarly() throws Exception {
		PushResult r;
		Transport tn = testProtocol.open(uri, client, "server");
		try {
			tn.setPushAtomic(true);
			r = tn.push(NullProgressMonitor.INSTANCE, commands());
		} finally {
			tn.close();
		}

		RemoteRefUpdate one = r.getRemoteUpdate("refs/heads/one");
		RemoteRefUpdate two = r.getRemoteUpdate("refs/heads/two");
		assertSame(
				RemoteRefUpdate.Status.REJECTED_OTHER_REASON,
				one.getStatus());
		assertSame(
				RemoteRefUpdate.Status.REJECTED_REMOTE_CHANGED,
				two.getStatus());
		assertEquals(JGitText.get().transactionAborted, one.getMessage());
	}

