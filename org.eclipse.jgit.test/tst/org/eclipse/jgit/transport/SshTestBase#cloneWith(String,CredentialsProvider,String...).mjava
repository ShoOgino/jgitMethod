	private void cloneWith(String uri, CredentialsProvider provider,
			String... config) throws Exception {
		installConfig(config);
		File cloned = new File(getTemporaryDirectory(), "cloned");
		CloneCommand clone = Git.cloneRepository().setCloneAllBranches(true)
				.setDirectory(cloned).setURI(uri);
		if (provider != null) {
			clone.setCredentialsProvider(provider);
		}
		try (Git git = clone.call()) {
			assertNotNull(git.getRepository().resolve("master"));
			assertNotEquals(db.getWorkTree(),
					git.getRepository().getWorkTree());
			checkFile(new File(git.getRepository().getWorkTree(), "file.txt"),
					"something");
		}
	}

