	@Test
	public void testParse_illegalEncoding() throws Exception {
		ByteArrayOutputStream b = new ByteArrayOutputStream();
		b.write("object 9788669ad918b6fcce64af8882fc9a81cb6aba67\n".getBytes(CHARSET));
		b.write("type tree\n".getBytes(CHARSET));
		b.write("tag v1.0\n".getBytes(CHARSET));
		b.write("tagger t <t@example.com> 1218123387 +0700\n".getBytes(CHARSET));
		b.write("encoding utf-8logoutputencoding=gbk\n".getBytes(CHARSET));
		b.write("\n".getBytes(CHARSET));
		b.write("message\n".getBytes(CHARSET));

		RevTag t = new RevTag(id("9473095c4cb2f12aefe1db8a355fe3fafba42f67"));
		t.parseCanonical(new RevWalk(db), b.toByteArray());

		assertEquals("t", t.getTaggerIdent().getName());
		assertEquals("message", t.getShortMessage());
		assertEquals("message\n", t.getFullMessage());
	}

