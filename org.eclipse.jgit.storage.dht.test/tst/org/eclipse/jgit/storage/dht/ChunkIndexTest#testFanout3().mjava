	@Test
	public void testFanout3() throws DhtException {
		List<PackedObjectInfo> objs = new ArrayList<PackedObjectInfo>(1 << 16);
		MutableObjectId idBuf = new MutableObjectId();
		for (int i = 0; i < 256; i++) {
			idBuf.setByte(2, i & 0xff);
			for (int j = 0; j < 256; j++) {
				idBuf.setByte(3, j & 0xff);
				PackedObjectInfo oe = new PackedObjectInfo(idBuf);
				oe.setOffset((i << 8) | j);
				objs.add(oe);
			}
		}
		ChunkIndex idx = index(objs);

		assertEquals(header(3, 2), header(objs));
		assertEquals(256 * 256, idx.getObjectCount());
		assertTrue(isSorted(objs));

		for (int i = 0; i < objs.size(); i++) {
			assertEquals(objs.get(i), idx.getObjectId(i));
			assertEquals(objs.get(i).getOffset(), idx.getOffset(i));
			assertEquals(objs.get(i).getOffset(), idx.findOffset(objs.get(i)));
		}
	}

