	@Test
	public void testObjects65280_ManyBuckets() throws DhtException {
		List<PackedObjectInfo> objs = new ArrayList<PackedObjectInfo>(65280);
		MutableObjectId idBuf = new MutableObjectId();
		for (int i = 0; i < 256; i++) {
			idBuf.setByte(0, i & 0xff);
			for (int j = 0; j < 255; j++) {
				idBuf.setByte(3, j & 0xff);
				PackedObjectInfo oe = new PackedObjectInfo(idBuf);
				oe.setOffset((i << 8) | j);
				objs.add(oe);
			}
		}
		ChunkIndex idx = index(objs);

		assertEquals(header(1, 2), header(objs));
		assertEquals(65280, idx.getObjectCount());
		assertTrue(isSorted(objs));

		for (int i = 0; i < objs.size(); i++) {
			assertEquals(objs.get(i), idx.getObjectId(i));
			assertEquals(objs.get(i).getOffset(), idx.getOffset(i));
			assertEquals(objs.get(i).getOffset(), idx.findOffset(objs.get(i)));
		}
	}

