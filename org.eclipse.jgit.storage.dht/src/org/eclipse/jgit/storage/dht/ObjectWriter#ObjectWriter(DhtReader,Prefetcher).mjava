	ObjectWriter(DhtReader ctx, Prefetcher prefetch) {
		this.ctx = ctx;
		this.prefetch = prefetch;

		batchSize = ctx.getOptions().getObjectIndexBatchSize();
		metaBatches = new Semaphore(batchSize);
		metaError = new AtomicReference<DhtException>();

		allVisits = new LinkedHashMap<ChunkKey, Integer>();
		allMeta = new HashMap<ChunkKey, ChunkMeta>();
		metaMissing = new HashSet<ChunkKey>();
		metaToRead = new HashSet<ChunkKey>();
		curVisit = 1;
	}

