	private static int tableSize(ChunkCacheConfig cfg) {
		final int csz = 1 * ChunkCacheConfig.MiB;
		final long limit = cfg.getChunkCacheLimit();
		if (limit == 0)
			return 0;
		if (csz <= 0)
			throw new IllegalArgumentException();
		if (limit < csz)
			throw new IllegalArgumentException();
		return (int) Math.min(5 * (limit / csz) / 2, 2000000000);
	}

